// #region all meals

// Creates all meals
let meal = {
  id: "meal1",
  name: "Traditional Cypriot Breakfast",
  description: "A typical cypriot breakfast that consists of toasted bread and fresh vegetables on the side.",
  image: "images/cypriotBreakfast.jpeg",
  stars: "4",
  timeToCook: "10mins",
  price: "8",
  dishDescription: "A very simple yet tasty breakfast that almost everyone eats in Cyprus. It consists of toasted bread  with butter accompanied by fresh tomatoes,cucumbers and olives as well as slices of ham and cheese or hallumi.",
  ingredients:[
    "bread",
    "butter",
    "tomatoes",
    "cucumbers",
    "olives of your preference",
    "hallumi",
    "ham",
    "any kind of cheese",
  ],  
  serveWith:
    "You can grill the hallumi cheese on a pan for extra flavour and have a side of yogurt to compliment the bread",
  howTo: "Toast the bread, add all your favourite vegetables, make some tea or coffee and enjoy a simple and delicous traditional cypriot braekfast.",
  hidden: false,
};

let meal2 = {
  id: "meal2",
  name: "Name of dish",
  description: "Description of dish",
  image: "Path to image",
  stars: "How many stars, integer without quotation marks",
  timeToCook: "Time in hours and minutes",
  price: "Price, integer without quotiation marks",
  dishDescription: "A longer description of the dish",
  ingredients:
    "List all ingredients needed. Write them inside [] and quotation marks between each ingredient",
  serveWith:
    "List some serving tips. Write them inside [] and quotation marks between each tip",
  howTo: "How to make the dish",
  hidden: false,
};

let meal3 = {
  id: "meal3",
  name: "Traditional Swedish Breakfast",
  description:
    "The Swedish breakfast consits of two slices of bread with butter and cheese, a boiled egg...",
  image: "images/SwedishBreakfast.png",
  stars: 4,
  timeToCook: "15 min",
  price: 5,
  dishDescription:
    "The Swedish breakfast consits of two slices of bread with butter and cheese, a boiled egg, muesli and other foods.",
  ingredients: [
    "Organge Juice",
    "Coffee",
    "Sandwich",
    "Butter",
    "Vegetables of your own choice",
    "Cheese",
    "Boiled eggs",
    "Muesli",
    "Yoghurt or filmjölk",
    "Berries for garnish",
  ],
  serveWith: [
    "Commonly used vegetables for breakfast is cucumber, bell pepper and tomatoes",
    "You can also add some cod roe spread (preferably Kalles) on the bread",
  ],
  howTo: "Serve all the items and enjoy your authentic Swedish breakfast!",
  hidden: false,
};

let meal4 = {
  id: "meal4",
  name: "Koupepia",
  description: "Koupepia are stuffed vine leaves with meat are very popular in Cyprus.",
  image: "images/koupepia.jpeg",
  stars: "5",
  timeToCook: "1hr",
  price: "20",
  dishDescription: "This famous dish Koupepia are delicious rolls of meat covered by grape leaves served with greek yogurt. ",
   ingredients: [
      "300 gr. grape leaves (fresh or frozen)",
      "1 kg minced meat of your choice",
      "6-7tomatoes",
      "2 onions finely chopped",
      "3 juiced lemons",
      "1 cup of rice",
      "parsely",
      "3 tbsp of dried mint leaves",
      "1/2 cup olive oil",
      "3 tsp of salt",
      "3tsp of pepper",
    ], 
    serveWith: [
      "Koupepia is perfectly served with yogurt berfore every bie, dip it in some greek yogurt for a hot and cold delicous sensation",
    ],
    howTo: [
      "Mix well the minced meat with all the ingredients (without the leaves) with a spoon or your hands",
      "After that, grap 2 spoons of the mixture and add it on a flat grape leaf and fold the two sides together inwards and start rolling to create a spring roll look",
      "Once you finished with the grape leaves and the mixture, place them all in a pot,add some olive oil and lemon and the vegetable stock dissolved in warm water",
      "Lastly, a plate that will cover the koupepia and to finish, pour some warm water until it reachers the plate and leave it to slowly cook. Wait for 40 minutes, then wait for another 10 minutes for them to cool and enjoy!",
    ],
  hidden: false,
};

let meal5 = {
  id: "meal5",
  name: "Name of dish",
  description: "Description of dish",
  image: "Path to image",
  stars: "How many stars, integer without quotation marks",
  timeToCook: "Time in hours and minutes",
  price: "Price, integer without quotiation marks",
  dishDescription: "A longer description of the dish",
  ingredients:
    "List all ingredients needed. Write them inside [] and quotation marks between each ingredient",
  serveWith:
    "List some serving tips. Write them inside [] and quotation marks between each tip",
  howTo: "How to make the dish",
  hidden: false,
};

let meal6 = {
  id: "meal6",
  name: "Potato pancakes with lingonberries",
  description:
    "Potato pancakes, aka raggmunk, has been a classic Swedish meal since the early 20th...",
  image: "images/potatoPancakes.jpeg",
  stars: 3,
  timeToCook: "30 min",
  price: 9,
  dishDescription:
    "Potato pancankes aka raggmunk has been a classic Swedish meal since the early 20th century.",
  ingredients: [
    "2 cups of whole milk",
    "3/4 cups of wheat flour",
    "2 teaspoons of salt",
    "1 large egg",
    "800 g of potatoes",
    "Butter to fry in",
  ],
  serveWith: ["Bacon or salted pork side, thinly sliced", "Lingonberry jam"],
  howTo:
    'Whisk together milk and flour in a bowl. Mix eggs and salt. Grate the potatoes on the fine or coarse part (more a matter of taste and what you like) of a grater and mix them into the batter. Let it rest for 30 minutes before frying the potato pancakes. Heat a generous dollop of butter in a frying pan. Pour about ½ cup of batter in the pan and fry to a thick pancake (about as thick as American pancakes), think about spreading the batter over the frying pan so that the grated potatoes is evenly spread throughout the "pancake" and not only as a pile in the middle. Fry on medium heat on both sides until the pancake is golden brown and crispy on the edges. Be careful not to overheat so that they get color before the potatoes is actually cooked, it takes about 4 minutes per side. Place the pancakes on a plate or in a baking dish and put them in the oven to keep them heated, on about 165 degrees Fahrenheit. Fry the bacon or sliced pork until they are golden and crispy, then let them drain on some paper or kitchen towels. Serve the warm potato pancakes with fried bacon or pork and lingonberry jam.',
  hidden: false,
};

let meal7 = {
  id: "meal7",
  name: "Avgolemoni",
  description: "A traditional cyprtiot soup served in the winter and during Easter.",
  image: "images/avgolemoni.jpg",
  stars: "5",
  timeToCook: "1hr 30min ",
  price: 15,
  dishDescription: "This soup is created with eggs,lemon and rice, 3 ingredients combined together creating a delicious flavour.",
  ingredients: [
      "4 eggs",
      "3 lemons",
      "2 tbs salt",
      "300g rice",
      "chicken",
    ]
      ,
  serveWith:
      "On a cold winter day, a warm soup of avgolemoni pairs great with a sliced of freshly warm bread.",
  howTo: [
     "Add water in a large pot and bring to a boil. Once boiled, add the chicken with a squeeze of half a lemon for flavour.",
     "Set a timer for 45 minutes, when the timer is done, set it aside.",
     "Remove the chicken from the stock and start shredding into pieces.",
     "Bring the pot to a boil after removing the chicken and add the rice.",
     "While its cooking, its time to start creating the main flavours of the soup.",
     "Add some stock in a bowl with the lemon juice, then crack the eggs in a mixing bowl and slowly add the lemon mixture.",
     "When you see it has foamed up a bit, you may add it to the pot and there you have a cypriot soup that will warm your heart.",
    ],
  hidden: false,
};

let meal8 = {
  id: "meal8",
  name: "Name of dish",
  description: "Description of dish",
  image: "Path to image",
  stars: "How many stars, integer without quotation marks",
  timeToCook: "Time in hours and minutes",
  price: "Price, integer without quotiation marks",
  dishDescription: "A longer description of the dish",
  ingredients:
    "List all ingredients needed. Write them inside [] and quotation marks between each ingredient",
  serveWith:
    "List some serving tips. Write them inside [] and quotation marks between each tip",
  howTo: "How to make the dish",
  hidden: false,
};

let meal9 = {
  id: "meal9",
  name: "Meatballs with mashed potatoes",
  description:
    "Sweden's #1 meal is meatballs, mashed potatoes and cream sauce.",
  image: "images/swedishMeatballs.jpeg",
  stars: 5,
  timeToCook: "1 hr",
  price: 10,
  dishDescription:
    "Every swede has their own favourite meatballs recipe and many celebrity chefs serve their own versions in their restaurants. Most people will say that their mum's recipe is the best of course!",
  ingredients: [
    "2 tablespoons breadcrumbs",
    "50 ml cream",
    "1 egg",
    "1 tablespoon concentrated beef stock",
    "1 yellow onion",
    "25 g butter",
    "500 g ground mince",
    "1 teaspoon ground black pepper",
    "1.5 teaspoons salt",
    "1 cup double cream",
    "1.5 teaspoon dark soy",
    "1 cup beef stock",
    "25 g butter",
    "1 tablespoon corn starch",
    "2 tablespoons lingonberry jam",
  ],
  serveWith: ["Potato mash", "Piffi spice (a Swedish spice mix)"],
  howTo:
    "Fold together bread crumbs, cream, stock and egg and leave to rest for about 5 minutes. Fry the onion in the butter until soft and then mix it with the breadcrumb-cream. Add salt, pepper and mince and work everything together, with your hands or fork. Try not to work it too much, as this will make the meatballs compact. Take a small piece of mince and fry it to test the flavours. When satisfied with salt and pepper, roll the rest of the mince to small balls (about one tablespoon mince per ball) Make sure your hands are wet with water, then the mince won’t stick to your hands. Fry the meatballs until golden brown and thoroughly cooked, then put aside. Mix cream and the corn starch and then pour this, stock and the soy in the pan where you fried the meatballs. Whisk through the pan and let boil for a couple of minutes. Taste with salt, pepper and jam for a little bit of sweetness. Put the meatballs back to the sauce and serve with mashed potatoes and lingonberry jam, maybe some chopped parsley on top too.",
  hidden: false,
};

let meal10 = {
  id: "meal10",
  name: "Loukoumades",
  description: "Loukoumades are little fluffy sweet honey balls, deep fried to golden and crispy perfection.",
  image: "images/loukoumades.jpeg",
  stars: 5,
  timeToCook: "1hr 30 min",
  price: 15,
  dishDescription: "Loukoumades are cypriot donuts and loved by everyone.",
  ingredients: [
    "8 grams of yeast",
    "3tbsp of flour",
    "1/4 cup of water",
    "1 tsp of sugar",
    "230 grams of all-purpose flour",
    "1 cup of water",
    "1/8 tsp of salt",
    "olive/vegetable oil",
    "honey/maple syrup",
    "crushed walnuts",
    "cinnamon"
    ]
      ,
  serveWith: [
    "These cypriot donuts are perfect with a cypriot cup of coffe.",
    ]
      ,
  howTo: [
    "Start by dissolving the yeast with warm water, sugar and 3 table spoons of flour, cover it and set aside.",
    "Add the rest of the ingredients together in a moxing bowl and mix them all togethe and cover with a table cloth.",
    "Add the oil in a pot so you can deep fry the donuts.",
    "Your dough should be flully anf bouncy now.",
    "Start scooping a good amount of dough and make small balls.",
    "Add them to the fryer, once they turn brown, they are finished.",
    "Once all are done, add some honey on top with crushed walnuts and cinnamon or if you want something more simple, add powdered sugar. Enjoy!",
    ],
  hidden: false,
};

let meal11 = {
  id: "meal11",
  name: "Name of dish",
  description: "Description of dish",
  image: "Path to image",
  stars: "How many stars, integer without quotation marks",
  timeToCook: "Time in hours and minutes",
  price: "Price, integer without quotiation marks",
  dishDescription: "A longer description of the dish",
  ingredients:
    "List all ingredients needed. Write them inside [] and quotation marks between each ingredient",
  serveWith:
    "List some serving tips. Write them inside [] and quotation marks between each tip",
  howTo: "How to make the dish",
  hidden: false,
};

let meal12 = {
  id: "meal12",
  name: "Semla",
  description:
    "A cream filled cardamom-flavoured bun that drives Swedes crazy around February.",
  image: "images/semla.jpg",
  stars: 4,
  timeToCook: "1 hr 15 min",
  price: 3,
  dishDescription:
    "This recipe will provide a semla that is a delicious way to celebrate Fat Tuesday! Semlor are a delicious tradition in Sweden, but you can make them in your own kitchen, no matter where you live!",
  ingredients: [
    "4 cups all purpose flour",
    "2 teaspoons dry yeast",
    "1/2 cup warm milk",
    "1/3 cup sugar",
    "1/3 cup melted butter",
    "1 teaspoon salt",
    "1 egg",
    "1 teaspoon cardamom",
    "1/2 cup lukewarm water",
    "1 egg yolk",
    "1 tablespoon cream",
    "1 egg white",
    "1/2 cup ground almond without skins",
    "3/4 cup powdered sugar",
  ],
  serveWith: ["Whipping cream", "Powdered sugar"],
  howTo:
    "In bread machine or stand mixer, place the lukewarm water, yeast and 1/2 tsp of sugar. Allow to rest for a few minutes, until the yeast begins to grow. Mix the milk, melted butter, beaten egg together, then add to the yeast mixture. Add the cardamom, flour, 1/3 cup of sugar and salt, and turn on machine (dough setting on bread machine or use a dough hook if using a stand mixer.) Mix and knead by hand if you aren't using a machine. Dough will be slightly sticky. Allow cycle to finish on dough setting; with stand mixer, or by hand, when the dough is ready, cover it and let rise on the counter until doubled in size. After it's risen, punch down the dough, and let rest for 5 minutes. Cut pieces of the dough and shape into round balls (about 15 to 18), and place onto a greased cookie sheet (or silicone sheet) about an inch apart. Place the tray in the oven (do not turn it on) to rise for about half an hour or until doubled in size. Once doubled, remove the buns from the oven and brush with the egg glaze (just mix the egg and cream together and brush on gently.) Preheat the oven to 350º F (175ºC) then cook the buns for approximately 20 minutes, or until golden brown. While they are baking, prepare the almond paste. Whip the egg white until soft peaks form, then fold in the ground almonds and powdered sugar. Cover and set aside. Remove the cooked buns from the tray, and place on a cooling rack. When the Semlor are completely cool, whip the cream and assemble them. Begin by cutting a top on each bun with a sharp knife, cutting down into the center of the bun to create a space for filling in the bun. Then put a teaspoonful, or more, of the almonds paste. Next, top with whipped cream. Place the top on the cream, and dust with powdered sugar. Repeat with remaining Semlor.",
  hidden: false,
};

// #endregion

const cards = document.getElementById("cards");
const searchInput = document.getElementById("searchInput");

const details = document.getElementById("details");
const detailsBackground = document.getElementById("detailsBackground");
const detailsName = document.getElementById("detailsName");
const image = document.getElementById("image");
const dishDescription = document.getElementById("dishDescription");
const ingredientsHeader = document.getElementById("ingredientsHeader");
const ingredients = document.getElementById("ingredients");
const serveWithHeader = document.getElementById("serveWithHeader");
const serveWith = document.getElementById("serveWith");
const howToHeader = document.getElementById("howToHeader");
const howTo = document.getElementById("howTo");
const clock = document.getElementById("clock");
const close = document.getElementById("close");

const starSolid = "icons/starSolid.svg";
const starOutlined = "icons/star.svg";

// Minimum characters requierd before search fiters results
const SEARCH_MINIMUM_CHAR_COUNT = 3;

// To place all meal cards on website
function spawnCard(meal) {
  const card = `<div id="${meal.id}" class="swedishBreakfast">
<img
  src="${meal.image}"
  alt="Swedish breakfast with hardbread, eggs and coffee."
/>
<h1>${meal.name}</h1>
<p class="description">
  ${meal.description}
</p>

<div class="time">
  <img src="icons/clock.svg" alt="" />
  <p class="timeToCook">${meal.timeToCook}</p>
</div>
<div class="price">
  <p>$ ${meal.price}</p>
</div>
<div class="reviews">
  <img id="${meal.id}star1" src="icons/starSolid.svg" alt="" />
  <img id="${meal.id}star2" src="icons/starSolid.svg" alt="" />
  <img id="${meal.id}star3" src="icons/starSolid.svg" alt="" />
  <img id="${meal.id}star4" src="icons/starSolid.svg" alt="" />
  <img id="${meal.id}star5" src="icons/starSolid.svg" alt="" />
</div>
</div>`;

  cards.innerHTML += card;
}

// Contains all meal items
let listOfMeals = [meal3, meal6, meal9, meal12];

// Display all meals as cards on website
listOfMeals.forEach((meal) => {
  spawnCard(meal);
  setStars(meal);
});

listOfMeals.forEach((meal) => {
  let element = document.getElementById(meal.id);
  element.addEventListener("click", function () {
    clickedMeal(meal);
  });
});

// #region search bar

// Makes the search bar functional.

// The following 6 lines of code was adapted from https://javascript.plainenglish.io/how-to-build-a-search-bar-7d8a8a3d9d00 20022-11-26
searchInput.addEventListener("keyup", (event) => {
  const { value } = event.target;

  // Transforms all letters to lowercase.
  const searchQuery = value.toLowerCase();

  // If three letters or more is written - a meal will appear on the screen. If not, all meals will be shown, this is also for when you remove letters.
  if (searchQuery.length >= SEARCH_MINIMUM_CHAR_COUNT) {
    listOfMeals.forEach((meal) => doesMealMatchSearch(meal, searchQuery));
  } else {
    listOfMeals.forEach((meal) => showMeal(meal));
  }
});

// Looks if the letters match with the meals, shows the meals it matches with and hides the other ones.
function doesMealMatchSearch(meal, searchString) {
  if (meal.name.toLowerCase().includes(searchString)) {
    showMeal(meal);
  } else {
    hideMeal(meal);
  }
}

// Function to hide and show meals.
function hideMeal(meal) {
  meal.hidden = true;
  let mealElement = document.getElementById(meal.id);
  mealElement.style.display = "none";
}

function showMeal(meal) {
  meal.hidden = false;
  let mealElement = document.getElementById(meal.id);
  mealElement.style.display = "block";
}

// #endregion

// Iactivates/activates stars in meal cards
function setStars(meal) {
  const parent = document.getElementById(meal.id);
  const star1 = parent.querySelector("#" + meal.id + "star1");
  const star2 = parent.querySelector("#" + meal.id + "star2");
  const star3 = parent.querySelector("#" + meal.id + "star3");
  const star4 = parent.querySelector("#" + meal.id + "star4");
  const star5 = parent.querySelector("#" + meal.id + "star5");

  if (meal.stars >= 1) {
    star1.src = starSolid;
  } else {
    star1.src = starOutlined;
  }
  if (meal.stars >= 2) {
    star2.src = starSolid;
  } else {
    star2.src = starOutlined;
  }
  if (meal.stars >= 3) {
    star3.src = starSolid;
  } else {
    star3.src = starOutlined;
  }
  if (meal.stars >= 4) {
    star4.src = starSolid;
  } else {
    star4.src = starOutlined;
  }
  if (meal.stars >= 5) {
    star5.src = starSolid;
  } else {
    star5.src = starOutlined;
  }
}

hideDetails();

function clickedMeal(meal) {
  dishDescription.innerText = meal.dishDescription;
  detailsName.innerText = meal.name;
  image.src = meal.image;
  meal.ingredients.forEach((ingredient) => {
    /* The following 3 lines of code was adapted from https://stackoverflow.com/questions/20673959/how-to-add-new-li-to-ul-onclick-with-javascript Accessed: 2022-11-29 */
    let li = document.createElement("li");
    li.appendChild(document.createTextNode(ingredient));
    ingredients.appendChild(li);
  });
  meal.serveWith.forEach((item) => {
    let li = document.createElement("li");
    li.appendChild(document.createTextNode(item));
    serveWith.appendChild(li);
  });
  howTo.innerText = meal.howTo;
  clock.innerText = meal.timeToCook;
  showDetails();
}

close.addEventListener("click", function () {
  hideDetails();
});

function hideDetails() {
  details.style.display = "none";
  detailsBackground.style.display = "none";
}

function showDetails() {
  details.style.display = "block";
  detailsBackground.style.display = "block";
}
